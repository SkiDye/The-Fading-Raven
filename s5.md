# 세션 5: UI & 폴리시

## 담당 범위
- UI 컴포넌트 통합
- 시각 효과 개선
- 설정/접근성
- 최종 테스트

## 구현 항목
1. **전투 UI 개선**
   - 크루 선택 패널
   - 스킬 버튼 + 쿨다운
   - 장비 사용 UI
   - Raven 능력 UI

2. **HUD 시스템** (`js/ui/hud.js`)
   - 웨이브 정보
   - 시설 상태
   - 크레딧/자원

3. **업그레이드 UI 개선**
   - 장비 장착/해제
   - 스킬 업그레이드
   - 특성 표시

4. **시각 효과**
   - 스킬 이펙트 개선
   - 적 사망 애니메이션
   - 화면 효과 (쉐이크 등)

5. **설정 & 접근성**
   - 사운드 시스템 (선택)
   - 게임 속도 조절
   - 툴팁/도움말

6. **최종 통합 테스트**
   - 전체 플로우 검증
   - 밸런스 조정
   - 버그 수정

## 산출물
- UI 관련 CSS/JS
- `docs/implementation/ui-components.md`

---

## 통합 테스트 피드백 (2026-02-03)

### 테스트 결과
```
Session 5: UI System - 31/31 ✓ (100%)
```

### 검증된 항목

**UI Components (`ui-components.js`):**
- [x] Tooltip (showAt, hide)
- [x] Toast (show, info, error)
- [x] ModalManager (open, close, confirm)
- [x] ProgressBar (create, update)
- [x] Loading (show, hide, wrap)

**Effects (`effects.js`):**
- [x] ScreenEffects (shake, flash, damage)
- [x] TransitionEffects (fade, slide)
- [x] ElementAnimations (pulse, wiggle, bounce, fadeIn/Out)
- [x] ParticleSystem (emit, explosion)
- [x] FloatingText (show, damage, heal)

**HUD (`hud.js`):**
- [x] init, updateWave, updateCrews, announceWave

**Battle Effects Integration (`battle-effects-integration.js`):**
- [x] init, patchBattleController

### 발견된 이슈

#### M-002: BattleController 의존성 처리
**우선순위:** Medium

**설명:**
`BattleEffectsIntegration.init()`이 `BattleController`가 없을 때 경고 메시지를 출력함.
이는 test.html 등 전투 페이지가 아닌 곳에서 로드될 때 발생.

**현재 동작:**
```javascript
if (typeof BattleController === 'undefined') {
    console.warn('BattleController not found, skipping effects integration');
    return;
}
```

**영향:**
- 기능상 문제 없음 (graceful degradation)
- 콘솔에 경고 메시지 출력

**권장 조치:**
1. 현재 동작 유지 (문제 없음)
2. 또는 전투 페이지에서만 로드하도록 조건 추가
3. 또는 경고 레벨을 debug로 변경

### CSS 로드 확인
- [x] ui-components.css
- [x] effects.css
- [x] hud.css

### 권장 개선사항
1. 설정 페이지 저장/로드 테스트
2. 접근성 옵션 (색맹 모드, 고대비) 실제 적용 확인
3. 게임 속도 조절 기능 전투에서 테스트
4. 사운드 시스템 통합 (향후)

---

## UX 플로우 검증 피드백 (2026-02-03)

### Medium Priority Issues

#### M-003: 구매 확인 절차 부재 ✅ RESOLVED
**우선순위:** Medium → **해결됨**
**해결일:** 2026-02-03 (검토 확인)

**설명:**
상점(upgrade.html)에서 스킬 업그레이드, 장비 구매 시
확인 절차 없이 즉시 크레딧 차감됨.

**구현 확인됨:**
- `upgrade.js:440-450`: `performUpgrade()` - ModalManager.confirm() 사용
- `upgrade.js:549-558`: `buyEquipment()` - ModalManager.confirm() 사용
- 모든 구매에 확인 다이얼로그 적용됨

---

#### M-004: 장비 해제 확인 부재 ✅ RESOLVED
**우선순위:** Medium → **해결됨**
**해결일:** 2026-02-03 (검토 확인)

**설명:**
장착된 장비를 해제할 때 확인 없이 즉시 해제됨.

**구현 확인됨:**
- `upgrade.js:357-387`: `unequipItem()` - ModalManager.confirm() 사용
- 해제 시 "해제된 장비는 소멸됩니다" 경고 표시

---

#### M-005: 업그레이드 효과 미리보기 부족 ✅ RESOLVED
**우선순위:** Medium → **해결됨**
**해결일:** 2026-02-03 (검토 확인)

**설명:**
스킬 업그레이드 전 효과 변화가 명확히 표시되지 않음.

**구현 확인됨:**
- `upgrade.js:462-475`: `getSkillPreview()` 메서드 구현
- `upgrade.js:412-416`: 업그레이드 확인 시 다음 레벨 효과 표시
- 확인 다이얼로그에 "효과: {description}" 포함

---

### Low Priority Issues

#### L-002: 키보드 단축키 도움말 부재 ✅ RESOLVED
**우선순위:** Low → **해결됨**
**해결일:** 2026-02-03

**설명:**
게임 내 키보드 단축키(일시정지, 스킬 사용 등)에 대한
도움말이나 설정 화면이 없음.

**구현된 단축키:**
- Space: 일시정지
- 1-9: 크루 선택
- Q: 스킬 사용
- E: 장비 사용
- ESC: 선택 해제 / 취소
- ?: 도움말 표시

**적용된 수정:**
- `battle.html`: 키보드 도움말 모달 추가 (`#keyboard-help-modal`)
- `battle.css`: 도움말 스타일 추가 (`.keyboard-help`, `.shortcut-*`)
- `battle.js`: `showKeyboardHelp()`, `hideKeyboardHelp()` 메서드 추가
- 일시정지 메뉴에 "단축키 도움말" 버튼 추가
- `?` 키로 도움말 토글 가능

---

#### L-003: 시드 형식 안내 부재 ✅ RESOLVED
**우선순위:** Low → **해결됨**
**해결일:** 2026-02-03 (검토 확인)

**설명:**
새 게임 시작 시 시드 입력란에 유효한 시드 형식에 대한 안내가 없음.

**구현 확인됨:**
- `index.html:58`: `placeholder="ABC1-DEF2-GH34"`
- `index.html:61`: `<p class="seed-hint">영문/숫자 조합 (예: ABC1-DEF2-GH34)<br>같은 시드로 동일한 맵을 재현할 수 있습니다</p>`

---

#### L-004: 난이도 해금 조건 표시 부재 ✅ RESOLVED
**우선순위:** Low → **해결됨**
**해결일:** 2026-02-03 (검토 확인)

**설명:**
잠긴 난이도에 대해 해금 조건이 표시되지 않음.

**구현 확인됨:**
- `difficulty.js:23-39`: 각 난이도별 `unlockCondition` 정의
- `difficulty.js:111-121`: 잠긴 난이도에 `<div class="locked-overlay"><span>🔒 ${unlockText}</span></div>` 표시
- 예: "🔒 보통 난이도 클리어"

---

#### L-005: 런 요약 정보 부족
**우선순위:** Low

**설명:**
게임 종료(승리/패배) 시 런에 대한 상세 통계가 부족함.

**추가할 정보:**
- 플레이 시간
- 처치한 적 유형별 수
- 획득/사용 크레딧 총계
- 사용한 스킬 횟수
- 클리어한 노드 목록

---

### UI 컴포넌트 검증

| 컴포넌트 | 기능 | 상태 | 비고 |
|----------|------|------|------|
| Tooltip | 호버 정보 | ✓ | |
| Toast | 알림 메시지 | ✓ | |
| ModalManager | 확인/입력 | ⚠️ | 구매 확인 미적용 |
| ProgressBar | 진행률 | ✓ | |
| Loading | 로딩 표시 | ✓ | |
| ScreenEffects | 화면 효과 | ⚠️ | 쉐이크 클릭 문제 |
| FloatingText | 데미지 표시 | ✓ | |
| HUD | 전투 정보 | ✓ | |

---

### 접근성 검증

| 항목 | 상태 | 비고 |
|------|------|------|
| 키보드 네비게이션 | ⚠️ | 일부 버튼 Tab 접근 불가 |
| 스크린 리더 | ❌ | aria-label 미적용 |
| 색맹 모드 | ⚠️ | 설정 존재, 효과 미확인 |
| 고대비 모드 | ⚠️ | 설정 존재, 효과 미확인 |
| 텍스트 크기 | ❌ | 조절 옵션 없음 |

---

### 시각 효과 검증

| 효과 | 작동 | 성능 | 비고 |
|------|------|------|------|
| 화면 쉐이크 | ✓ | ✓ | 클릭 오프셋 문제 |
| 화면 플래시 | ✓ | ✓ | |
| 파티클 | ✓ | ⚠️ | 다수 생성 시 확인 필요 |
| 페이드 전환 | ✓ | ✓ | |
| 플로팅 텍스트 | ✓ | ✓ | |

---

### 추가 검증 필요 항목
1. [ ] 설정 저장/로드 영속성
2. [ ] 게임 속도 조절 실제 동작
3. [ ] 모바일/터치 지원 여부
4. [ ] 저사양 기기 성능 테스트
5. [ ] 다국어 지원 준비 상태
